/**
 * systemConfig.js - My Simulator
 * 
 * Generated by Process Simulator Designer v2.0.0
 * Export Date: 10/15/2025, 6:44:40 AM
 * 
 * ‚ö†Ô∏è IMPORTANT PATH REQUIREMENTS:
 * This file expects the following structure:
 *   sims/my-simulator/
 *   ‚îú‚îÄ‚îÄ index.html
 *   ‚îú‚îÄ‚îÄ systemConfig.js (this file)
 *   ‚îî‚îÄ‚îÄ README.md
 *   
 *   engine/ (at ../../engine/ from this file)
 *   ‚îú‚îÄ‚îÄ core/
 *   ‚îú‚îÄ‚îÄ components/
 *   ‚îî‚îÄ‚îÄ managers/
 *   
 *   valve.html (at ../../valve.html from this file)
 */

const SYSTEM_CONFIG = {
  "_metadata": {
    "name": "My Simulator",
    "version": "1.0.0",
    "exportVersion": "2.0.0",
    "designerVersion": "2.0.0",
    "exported": "2025-10-15T11:44:40.776Z",
    "componentCount": 6,
    "connectionCount": 5
  },
  "feeds": {
    "comp_2": {
      "id": "comp_2",
      "name": "Feed 3",
      "type": "feed",
      "supplyPressure": 3,
      "maxFlow": null,
      "temperature": 20,
      "inputs": [],
      "outputs": [
        "comp_3"
      ],
      "position": [
        140,
        -40
      ]
    }
  },
  "drains": {
    "comp_6": {
      "id": "comp_6",
      "name": "Drain 7",
      "type": "drain",
      "ambientPressure": 1,
      "maxCapacity": null,
      "inputs": [
        "comp_5"
      ],
      "outputs": [],
      "position": [
        820,
        -40
      ]
    }
  },
  "tanks": {
    "comp_1": {
      "id": "comp_1",
      "name": "Tank 2",
      "type": "tank",
      "area": 2.5,
      "maxHeight": 1.2,
      "initialVolume": 0,
      "inputs": [
        "comp_3"
      ],
      "outputs": [
        "comp_4"
      ],
      "svgElement": "#comp_1",
      "position": [
        440,
        180
      ]
    }
  },
  "pumps": {
    "comp_4": {
      "id": "comp_4",
      "name": "Fixed Speed Pump 5",
      "type": "pump",
      "pumpType": "fixed",
      "capacity": 0.5,
      "efficiency": 0.95,
      "inputs": [
        "comp_1"
      ],
      "outputs": [
        "comp_5"
      ],
      "svgElement": "#comp_4",
      "position": [
        620,
        220
      ],
      "modalTitle": "Fixed Speed Pump 5 Control"
    }
  },
  "valves": {
    "comp_3": {
      "id": "comp_3",
      "name": "Control Valve 4",
      "type": "valve",
      "maxFlow": 0.5,
      "initialPosition": 0,
      "responseTime": 0.1,
      "inputs": [
        "comp_2"
      ],
      "outputs": [
        "comp_1"
      ],
      "svgElement": "#comp_3",
      "position": [
        320,
        -40
      ],
      "iframeUrl": "../../valve.html",
      "modalTitle": "Control Valve 4 Control"
    },
    "comp_5": {
      "id": "comp_5",
      "name": "Control Valve 6",
      "type": "valve",
      "maxFlow": 0.5,
      "initialPosition": 0,
      "responseTime": 0.1,
      "inputs": [
        "comp_4"
      ],
      "outputs": [
        "comp_6"
      ],
      "svgElement": "#comp_5",
      "position": [
        620,
        -40
      ],
      "iframeUrl": "../../valve.html",
      "modalTitle": "Control Valve 6 Control"
    }
  },
  "pipes": {
    "pipe1": {
      "id": "pipe1",
      "name": "Feed 3 to Control Valve 4",
      "type": "pipe",
      "diameter": 0.05,
      "length": 0.2,
      "svgElement": "#pipe1Flow",
      "inputs": [
        "comp_2"
      ],
      "outputs": [
        "comp_3"
      ]
    },
    "pipe2": {
      "id": "pipe2",
      "name": "Control Valve 4 to Tank 2",
      "type": "pipe",
      "diameter": 0.05,
      "length": 0.3,
      "svgElement": "#pipe2Flow",
      "inputs": [
        "comp_3"
      ],
      "outputs": [
        "comp_1"
      ]
    },
    "pipe3": {
      "id": "pipe3",
      "name": "Tank 2 to Fixed Speed Pump 5",
      "type": "pipe",
      "diameter": 0.05,
      "length": 0.2,
      "svgElement": "#pipe3Flow",
      "inputs": [
        "comp_1"
      ],
      "outputs": [
        "comp_4"
      ]
    },
    "pipe4": {
      "id": "pipe4",
      "name": "Fixed Speed Pump 5 to Control Valve 6",
      "type": "pipe",
      "diameter": 0.05,
      "length": 0.3,
      "svgElement": "#pipe4Flow",
      "inputs": [
        "comp_4"
      ],
      "outputs": [
        "comp_5"
      ]
    },
    "pipe5": {
      "id": "pipe5",
      "name": "Control Valve 6 to Drain 7",
      "type": "pipe",
      "diameter": 0.05,
      "length": 0.2,
      "svgElement": "#pipe5Flow",
      "inputs": [
        "comp_5"
      ],
      "outputs": [
        "comp_6"
      ]
    }
  },
  "pressureSensors": {},
  "settings": {
    "timeStep": 0.016,
    "maxTimeStep": 0.1,
    "gravity": 9.81,
    "fluidDensity": 1000,
    "updateInterval": 16,
    "debugMode": true,
    "logFlows": false
  }
};

// Validation
function validateConfig(config) {
  const errors = [];
  const allIds = new Set();
  
  for (const [category, items] of Object.entries(config)) {
    if (category === 'settings' || category === '_metadata') continue;
    for (const [key, item] of Object.entries(items)) {
      if (allIds.has(item.id)) {
        errors.push(`Duplicate ID: ${item.id}`);
      }
      allIds.add(item.id);
    }
  }
  
  if (errors.length > 0) {
    console.error('Configuration errors:', errors);
    return false;
  }
  
  console.log('‚úì Configuration validated');
  return true;
}

// Version check
function checkEngineVersion() {
  const required = '1.0.0';
  const current = window.ENGINE_VERSION || 'unknown';
  
  if (current !== required && current !== 'unknown') {
    console.warn(`‚ö†Ô∏è Engine version mismatch: Config expects ${required}, found ${current}`);
  }
}

// Export
window.SYSTEM_CONFIG = SYSTEM_CONFIG;
window.validateConfig = validateConfig;

// Auto-validate
if (validateConfig(SYSTEM_CONFIG)) {
  checkEngineVersion();
  console.log('‚úÖ System configuration loaded');
  console.log('üìã Components:', {
    feeds: Object.keys(SYSTEM_CONFIG.feeds).length,
    tanks: Object.keys(SYSTEM_CONFIG.tanks).length,
    pumps: Object.keys(SYSTEM_CONFIG.pumps).length,
    valves: Object.keys(SYSTEM_CONFIG.valves).length,
    drains: Object.keys(SYSTEM_CONFIG.drains).length,
    pipes: Object.keys(SYSTEM_CONFIG.pipes).length,
    sensors: Object.keys(SYSTEM_CONFIG.pressureSensors).length
  });
}