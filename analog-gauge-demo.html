<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Analog Gauge Demo</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: system-ui, -apple-system, sans-serif;
      background: linear-gradient(135deg, #1e3a8a 0%, #1e293b 100%);
      color: #f1f5f9;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    h1 {
      margin-bottom: 30px;
      font-size: 2rem;
      text-align: center;
    }

    .gauge-container {
      background: white;
      border-radius: 20px;
      padding: 20px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
      max-width: 800px;
      width: 100%;
    }

    #gauge-svg {
      width: 100%;
      height: auto;
      display: block;
    }

    .controls {
      margin-top: 30px;
      background: #0f172a;
      padding: 20px;
      border-radius: 10px;
      max-width: 800px;
      width: 100%;
    }

    .control-group {
      margin-bottom: 20px;
    }

    .control-group:last-child {
      margin-bottom: 0;
    }

    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      font-size: 0.9rem;
    }

    input[type="range"] {
      width: 100%;
      height: 8px;
      border-radius: 5px;
      background: #334155;
      outline: none;
      -webkit-appearance: none;
    }

    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #3b82f6;
      cursor: pointer;
    }

    input[type="range"]::-moz-range-thumb {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #3b82f6;
      cursor: pointer;
      border: none;
    }

    .value-display {
      text-align: center;
      font-size: 1.5rem;
      font-weight: bold;
      color: #3b82f6;
      margin-top: 10px;
    }

    .info {
      margin-top: 20px;
      padding: 15px;
      background: #1e293b;
      border-radius: 8px;
      font-size: 0.9rem;
    }

    .info-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
    }

    .info-row:last-child {
      margin-bottom: 0;
    }

    .info-label {
      color: #94a3b8;
    }

    .info-value {
      color: #f1f5f9;
      font-weight: 600;
    }

    .status-indicator {
      display: inline-block;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      margin-right: 8px;
    }

    .status-normal { background: #10b981; }
    .status-warning { background: #f59e0b; }
    .status-critical { background: #ef4444; }

    button {
      background: #3b82f6;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 1rem;
      margin-right: 10px;
      margin-top: 10px;
    }

    button:hover {
      background: #2563eb;
    }

    button:active {
      background: #1d4ed8;
    }
  </style>
</head>
<body>

<h1>Dynamic Analog Gauge Demo</h1>

<div class="gauge-container">
  <svg id="gauge-svg" viewBox="0 0 800 800" xmlns="http://www.w3.org/2000/svg">
    <!-- Embedded SVG from guageAnalog.svg -->
    <style type="text/css">
      .st0{fill:#1C1C1C;}
      .st1{fill:#9BA2A7;}
      .st2{fill:#F9A03F;}
      .st3{fill:#384550;}
      .st4{fill:#E6E9EE;}
      .st5{fill:#2B3B4E;}
      .st6{fill:#ACB3BA;}
      .st7{fill:#FF7058;}
      .st8{fill:#BE872D;stroke:#55FF00;stroke-miterlimit:10;}
      .st9{fill:#FCE96A;}
    </style>
    <g>
      <circle id="stationarypivotpoint" class="st0" cx="400" cy="400" r="1"/>
      <g>
        <g>
          <rect x="297" y="550" class="st1" width="206" height="500"/>
          <g>
            <circle class="st2" cx="400" cy="400" r="400"/>
            <path class="st3" d="M400,703.6C232.4,703.6,96.4,567.6,96.4,400S232.4,96.4,400,96.4S703.6,232.4,703.6,400
              S567.6,703.6,400,703.6z"/>
          </g>
          <circle class="st4" cx="400" cy="400" r="241.2"/>
        </g>
        <g id="detail">
          <g>
            <g>
              <circle class="st5" cx="400" cy="129.8" r="15.7"/>
              <circle class="st5" cx="400" cy="670.2" r="15.7"/>
              <circle class="st5" cx="670.2" cy="400" r="15.7"/>
              <circle class="st5" cx="129.8" cy="400" r="15.7"/>
            </g>
          </g>
          <g id="markers">
            <g>
              <path id="_x31_00_percent" class="st6" d="M572.2,471.3L572.2,471.3c1.3-4,6.2-6.2,10.2-4l15.6,6.7c4,1.3,6.2,6.2,4,10.2l0,0
                c-1.3,4-6.2,6.2-10.2,4l-15.6-6.7C572.2,480.2,569.9,475.3,572.2,471.3z"/>
              <path id="_x39_0_percent" class="st6" d="M618.5,400L618.5,400c0,4.5-3.6,8-8,8l-16.9,0c-4.5,0-8-3.6-8-8l0,0c0-4.5,3.6-8,8-8
                h16.9C614.9,392,618.5,395.5,618.5,400z"/>
              <path id="_x38_0_percent" class="st6" d="M602.4,316.3L602.4,316.3c1.3,4-0.4,8.5-4,10.2l-15.6,6.7c-4,1.3-8.5-0.4-10.2-4l0,0
                c-1.3-4,0.4-8.5,4-10.2l15.6-6.7C595.8,310.5,600.2,312.3,602.4,316.3z"/>
              <path id="_x37_0_percent" class="st6" d="M531.7,268.3L531.7,268.3c-3.1-3.1-3.1-8.2,0-11.3l12-12c3.1-3.1,8.2-3.1,11.3,0l0,0
                c3.1,3.1,3.1,8.2,0,11.3l-12,12C539.2,271.5,534.2,271.5,531.7,268.3z"/>
              <path id="_x36_0_percent" class="st6" d="M471.2,228L471.2,228c-3.8-1.9-5.7-6.3-4.4-10.1l6.3-15.7c1.9-3.8,6.3-5.7,10.1-4.4
                l0,0c3.8,1.9,5.7,6.3,4.4,10.1l-6.3,15.7C480,228,475,229.9,471.2,228z"/>
              <path id="_x35_0_percent" class="st6" d="M400,214.2L400,214.2c-4.4,0-8.2-3.8-8.2-8.2v-17c0-4.4,3.8-8.2,8.2-8.2l0,0
                c4.4,0,8.2,3.8,8.2,8.2v17C408.2,210.4,404.4,214.2,400,214.2z"/>
              <path id="_x34_0_percent" class="st6" d="M328.8,228L328.8,228c-3.8,1.9-8.8,0-10.1-4.4l-6.3-15.7c-1.9-3.8,0-8.8,4.4-10.1l0,0
                c3.8-1.9,8.8,0,10.1,4.4l6.3,15.7C335.1,221.7,333.2,226.8,328.8,228z"/>
              <path id="_x33_0_percent" class="st6" d="M268.3,269.1L268.3,269.1c-2.8,3.2-8.1,3.4-11-0.2l-11.8-12.1
                c-3.2-2.8-3.4-8.1,0.2-11l0,0c2.8-3.2,8.1-3.4,11,0.2l11.8,12.1C271.7,260.9,271.9,266.3,268.3,269.1z"/>
              <path id="_x32_0_percent" class="st6" d="M227.8,329.5L227.8,329.5c-1.7,4.1-6.4,6-10.5,4.3l-15.6-6.5c-4.1-1.7-6-6.4-4.3-10.5
                l0,0c1.7-4.1,6.4-6,10.5-4.3l15.6,6.5C227.9,321.3,229.8,325.9,227.8,329.5z"/>
              <path id="_x31_0_percent" class="st6" d="M213.7,400.8L213.7,400.8c-0.3,4.2-3.7,7.6-7.6,7.9l-17,0.2c-4.2-0.3-7.6-3.7-7.9-7.6
                l0,0c0.3-4.2,3.7-7.6,7.6-7.9l17-0.2C210.3,392.6,214,396.6,213.7,400.8z"/>
              <path id="_x30__percent" class="st6" d="M228.1,471.8L228.1,471.8c1.7,4.1-0.4,9-4.4,10.7l-15.7,6.5c-4.1,1.7-9-0.4-10.7-4.4
                l0,0c-1.7-4.1,0.4-9,4.4-10.7l15.7-6.5C221.5,465.7,226.4,467.8,228.1,471.8z"/>
            </g>
          </g>
        </g>
      </g>
    </g>
    <g id="pointer">
      <path id="pointer_00000060746675069509377280000017987503526150613890_" class="st7" d="M324.2,242.7c-1.3-1.9-3.1-2.5-5-1.3
        c-1.9,0.6-3.1,3.1-1.9,5l66.1,159.4c0.6,0.6,0.6,1.9,1.3,2.5c5,8.2,15.7,10.7,23.9,5.7c8.2-5,10.7-15.7,5.7-23.9L324.2,242.7z"/>
      <g>
        <line id="arrow_pointer" class="st8" x1="400" y1="400" x2="319.1" y2="241.4"/>
        <circle id="rotatingpiviotpinpointer" class="st0" cx="400" cy="400" r="1"/>
      </g>
    </g>
    <circle id="center_cover" class="st9" cx="400" cy="400" r="43.5"/>
  </svg>
</div>

<div class="controls">
  <div class="control-group">
    <label for="valueSlider">Gauge Value: <span id="sliderValue">0</span>%</label>
    <input type="range" id="valueSlider" min="0" max="100" value="0" step="1">
  </div>

  <div class="control-group">
    <button onclick="setRandomValue()">Random Value</button>
    <button onclick="animate()">Animate 0-100%</button>
    <button onclick="resetGauge()">Reset</button>
  </div>

  <div class="info">
    <div class="info-row">
      <span class="info-label">Status:</span>
      <span class="info-value"><span id="statusIndicator" class="status-indicator status-normal"></span><span id="statusText">NORMAL</span></span>
    </div>
    <div class="info-row">
      <span class="info-label">Current Value:</span>
      <span class="info-value" id="currentValue">0%</span>
    </div>
    <div class="info-row">
      <span class="info-label">Rotation Angle:</span>
      <span class="info-value" id="currentAngle">-135Â°</span>
    </div>
    <div class="info-row">
      <span class="info-label">Color Zone:</span>
      <span class="info-value" id="colorZone">green</span>
    </div>
  </div>
</div>

<!-- Include the base Component class -->
<script src="js/core/Component.js"></script>
<!-- Include the AnalogGauge component -->
<script src="js/components/sensors/AnalogGauge.js"></script>

<script>
  // Create gauge instance
  const gauge = new AnalogGauge({
    id: 'gauge_demo',
    name: 'Demo Gauge',
    type: 'sensor',
    value: 0,
    minValue: 0,
    maxValue: 100,
    units: '%',
    svgElement: '#gauge-svg',
    smoothing: true,
    smoothingFactor: 0.15
  });

  // Get DOM elements
  const slider = document.getElementById('valueSlider');
  const sliderValue = document.getElementById('sliderValue');
  const currentValue = document.getElementById('currentValue');
  const currentAngle = document.getElementById('currentAngle');
  const statusText = document.getElementById('statusText');
  const statusIndicator = document.getElementById('statusIndicator');
  const colorZone = document.getElementById('colorZone');

  // Update gauge value from slider
  slider.addEventListener('input', (e) => {
    const value = parseFloat(e.target.value);
    gauge.setValue(value);
    sliderValue.textContent = value;
    updateInfo();
  });

  // Animation loop
  let lastTime = performance.now();
  function animate() {
    const now = performance.now();
    const dt = (now - lastTime) / 1000; // Convert to seconds
    lastTime = now;

    // Update gauge (smooth interpolation)
    gauge.update(dt);

    // Render gauge (apply rotation)
    gauge.render();

    // Update info display
    updateInfo();

    requestAnimationFrame(animate);
  }

  // Update info display
  function updateInfo() {
    const info = gauge.getInfo();
    currentValue.textContent = info.percentage;
    currentAngle.textContent = info.angle;
    statusText.textContent = info.status;
    colorZone.textContent = info.zone;

    // Update status indicator color
    statusIndicator.className = 'status-indicator';
    if (info.status === 'CRITICAL') {
      statusIndicator.classList.add('status-critical');
    } else if (info.status === 'WARNING') {
      statusIndicator.classList.add('status-warning');
    } else {
      statusIndicator.classList.add('status-normal');
    }
  }

  // Set random value
  function setRandomValue() {
    const randomValue = Math.floor(Math.random() * 101);
    slider.value = randomValue;
    gauge.setValue(randomValue);
    sliderValue.textContent = randomValue;
    updateInfo();
  }

  // Animate from 0 to 100%
  let animationRunning = false;
  function animateToMax() {
    if (animationRunning) return;

    animationRunning = true;
    let currentVal = 0;

    const interval = setInterval(() => {
      currentVal += 1;
      gauge.setValue(currentVal);
      slider.value = currentVal;
      sliderValue.textContent = currentVal;
      updateInfo();

      if (currentVal >= 100) {
        clearInterval(interval);
        animationRunning = false;
      }
    }, 30);
  }

  // Reset gauge
  function resetGauge() {
    gauge.reset();
    slider.value = 0;
    sliderValue.textContent = 0;
    updateInfo();
  }

  // Start animation loop
  animate();
  updateInfo();
</script>

</body>
</html>
